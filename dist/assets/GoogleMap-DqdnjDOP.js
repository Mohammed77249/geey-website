import{L as j,$ as W,E as F}from"./index-BxvPaAYS.js";import{al as d,r,o as u,c as k,e as o,g as M,w,F as O,h as V,C as x,f as p,t as h,k as b}from"./desktop-pages-DK1eHo7S.js";import"./phone-pages-DQteHvqF.js";const q={key:0,class:"fixed inset-0 flex items-center justify-center z-50"},D={class:"flex flex-col items-center h-full md:max-h-[600px] p-2 bg-gray-200 w-full max-w-2xl"},G={class:"w-full h-4/5"},H={__name:"GoogleMap",props:{isOpen:{type:Boolean,required:!0}},emits:["close"],setup(C,{emit:_}){const T=C,U=d({lat:15.369445,lng:44.191006}),m=d([{lat:15.369445,lng:44.191006}]),L=r(12),n=d({visible:!1,position:{lat:0,lng:0}}),f=r(null),y=r(null),i=r(null),c=r(null),N=(t,e)=>{n.position=e,n.visible=!0},$=async t=>{const e=t.latLng;f.value=e.lat(),y.value=e.lng(),m.push({lat:e.lat(),lng:e.lng()}),await z(e.lat(),e.lng())},z=async(t,e)=>{const s=`https://nominatim.openstreetmap.org/reverse?format=json&lat=${t}&lon=${e}&zoom=10&addressdetails=1`;try{const a=await(await fetch(s,{headers:{"User-Agent":"Mozilla/5.0 (YourAppName)"}})).json();if(a.address){const S=a.address.city||a.address.town||a.address.village||"Unknown",v=E(S);console.log("Cleaned City:",v),i.value=v,c.value=a.address.state||"Unknown"}else console.error("Address not found in API response"),i.value="Unknown",c.value="Unknown"}catch(l){console.error("Error fetching address from Nominatim:",l),i.value="Unknown",c.value="Unknown"}},E=t=>t?(["مدينة","محافظة","ولاية"].forEach(s=>{const l=new RegExp(`${s}\\s*`,"gi");t=t.replace(l,"").trim()}),t):"Unknown",g=_,I=()=>{localStorage.setItem("long",y.value),localStorage.setItem("lat",f.value),localStorage.setItem("city",i.value||"Unknown"),localStorage.setItem("region",c.value||"Unknown"),g("close")},A=()=>{g("close")},B=d({styles:[{elementType:"geometry",stylers:[{color:"#ebe3cd"}]},{elementType:"labels.text.fill",stylers:[{color:"#523735"}]},{elementType:"labels.text.stroke",stylers:[{color:"#f5f1e6"}]},{featureType:"administrative",elementType:"geometry.stroke",stylers:[{color:"#c9b2a6"}]},{featureType:"landscape.man_made",elementType:"geometry",stylers:[{color:"#f0f0f0"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#ffffff"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#aaddff"}]}]});return(t,e)=>T.isOpen?(u(),k("div",q,[o("div",D,[o("div",{class:"flex justify-end items-center"},[o("button",{onClick:A,class:"text-primary-900 text-[20px] hover:text-black"}," × ")]),o("div",G,[M(p(F),{center:U,zoom:L.value,options:B,class:"h-full w-full",onClick:$},{default:w(()=>[(u(!0),k(O,null,V(m,(s,l)=>(u(),x(p(j),{key:l,position:s,clickable:!0,draggable:!0,onClick:a=>N(l,s)},null,8,["position","onClick"]))),128)),n.visible?(u(),x(p(W),{key:0,position:n.position,onCloseclick:e[0]||(e[0]=s=>n.visible=!1)},{default:w(()=>[o("div",null,[o("p",null,"Latitude: "+h(n.position.lat),1),o("p",null,"Longitude: "+h(n.position.lng),1)])]),_:1},8,["position"])):b("",!0)]),_:1},8,["center","zoom","options"])]),o("div",{class:"flex space-x-4 mt-4"},[o("button",{class:"px-4 py-2 bg-primary-900 text-white rounded",onClick:I}," حفظ ")])])])):b("",!0)}};export{H as default};
